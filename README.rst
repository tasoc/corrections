=======================================
The TASOC Lightcurve Corrections module
=======================================
.. image:: https://travis-ci.org/tasoc/corrections.svg?branch=devel
    :target: https://travis-ci.org/tasoc/corrections
.. image:: https://img.shields.io/codecov/c/github/tasoc/corrections
    :target: https://codecov.io/github/tasoc/corrections
.. image:: https://hitsofcode.com/github/tasoc/corrections?branch=devel
    :alt: Hits-of-Code
    :target: https://hitsofcode.com/view/github/tasoc/corrections?branch=devel
.. image:: https://img.shields.io/github/license/tasoc/corrections.svg
    :alt: license
    :target: https://github.com/tasoc/corrections/blob/master/LICENSE
This module provides the lightcurve corrections setup for the TESS Asteroseismic Science Operations Center (TASOC).

The code is available through our GitHub organization (https://github.com/tasoc/corrections) and full documentation for this code can be found on https://tasoc.dk/code/.

.. note::
    The TASOC Corrections Pipeline is based on co-trending of lightcurves and is created with the primary purpose of correcting all lightcurves in a full TESS observing sector.
    It therefore fundamentally requires a full set of lightcurves, together with the databases generated by the TASOC Photometry pipeline to function.

Installation instructions
=========================
* Start by making sure that you have `Git Large File Storage (LFS) <https://git-lfs.github.com/>`_ installed. You can verify that is installed by running the command:

  >>> git lfs version

* Go to the directory where you want the Python code to be installed and simply download it or clone it via *git* as::

  >>> git clone https://github.com/tasoc/corrections.git .

* All dependencies can be installed using the following command. It is recommended to do this in a dedicated `virtualenv <https://virtualenv.pypa.io/en/stable/>`_ or similar:

  >>> pip install -r requirements.txt

How to run tests
================
You can test your installation by going to the root directory where you cloned the repository and run the command:

>>> pytest

This will run all basic tests, which ensures that basic functionality is working.

Since several of the correction methods are based on cotrending, these methods require access to a full sector of TESS light curves in order to build the cotrending.
This includes e.g. the building of cotrending basis vectors (CBVs) or the Ensemble corrections. In order to test these methods, it is possible to run the following script,
which will download a batch of raw light curves from a single TESS CCD, approximately 4.8 GB in size, extracted with the `TASOC Photometry pipeline <https://github.com/tasoc/photometry>`_:

>>> python run_download_test_data.py

This will automatically download and unpack the required data into the program directories. Subsequent calls of ``pytest`` will automatically detect that the data have been downloaded and run the more thorough tests.

Running the program
===================

More text coming soon...

>>> python run_tesscorr.py --method=cbv 
